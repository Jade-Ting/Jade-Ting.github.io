---
layout: post
title:  "å­¦ä¹ lessçš„ç¬”è®°"
date: 2020-01-12 10:56:16 +0800
tags: less
color: rgb(125,185,222)
cover: '../assets/image/2020-01-12.jpg'
subtitle: 'å¾ˆä¹…ä¹‹å‰å­¦ä¹ lessçš„ç¬”è®°~ğŸ˜‹'
---

> åŸæœ¬çš„ç¬”è®°æœ‰ç‚¹å¤šä¸”ç¹ç~è‡ªå·±çœ‹çš„éƒ½æœ‰ç‚¹æ™•ï¼Œæ‰€ä»¥åªé€‰éƒ¨åˆ†ğŸ˜…

> [Lesså‡½æ•°æ‰‹å†Œ](https://less.bootcss.com/functions/)
> |[å‚è€ƒ](http://www.maiziedu.com/wiki/css/colour/)
> |[å‚è€ƒ SimonMa](https://juejin.im/post/5a2bc28f6fb9a044fe464b19)
> |[ä¸­æ–‡æ–‡æ¡£](https://www.html.cn/doc/less/features/#variables-feature)

## å¾ªç¯ Loops

åœ¨lessä¸­ï¼Œmixinå¯ä»¥è°ƒç”¨è‡ªèº«ï¼Œ å½“ä¸€ä¸ªmixiné€’å½’è°ƒç”¨è‡ªå·±ï¼Œå°±èƒ½å½¢æˆå¾ªç¯ç»“æ„

- å®ä¾‹

  ```less
  // .lessæ–‡ä»¶
  .loop(@count, @percent) when (@count > 0) {
    .colorPurple@{count} {                 // ç”Ÿæˆ count ä¸ªç±»å
      color: lighten(#a374d5, @percent); // æ¯æ¬¡è°ƒç”¨æ—¶äº§ç”Ÿçš„æ ·å¼ä»£ç 
    }
    .loop((@count - 1), (@percent + 10%)); // é€’å½’è°ƒç”¨è‡ªèº«
  }

  .test {
    .loop(10, 10%);
  }

  // demo.jsä¸­è°ƒç”¨
  <div className={style.test}>
      <div className={style.colorPurple5}>æµ‹è¯•</div> // æ­¤æ—¶colorPurpleå¯ä»¥è°ƒç”¨çš„æŒ¡ä½æœ‰colorPurple1-colorPurple10
  </div>

  <!--å¾—åˆ°â€˜æµ‹è¯•â€™ä¸¤ä¸ªå­—çš„é¢œè‰²ä¸º 60%çš„ #a374d5-->
  ```

- ä½¿ç”¨é€’å½’å¾ªç¯ç”Ÿæˆæ …æ ¼ç³»ç»Ÿ

  ```less

  .generate-columns(@n, @i: 1) when (@i =< @n) {
      .column-@{i} {
          width: (@i * 100% / @n);
      }
      .generate-columns(@n, (@i + 1));
  }

  // è°ƒç”¨
  .generate-columns(4);

  // è¾“å‡ºcss
  .column-1 {
    width: 25%;
  }
  .column-2 {
    width: 50%;
  }
  .column-3 {
    width: 75%;
  }
  .column-4 {
    width: 100%;
  }
  <!--å³ï¼šå†ä½¿ç”¨çš„æ—¶å€™ï¼Œåªè¦è°ƒç”¨className=column-nå°±å¯ä»¥äº†-->
  ```


## éå†

åœ¨lessä¸­éå†æ•°ç»„

  ```less
  @colors: red, green, blue, black; // å®šä¹‰æ•°ç»„å…ƒç´ 

  .for(@data, @i: 1) when(@i =< length(@data)) { // length(@data) è·å–æ•°ç»„é•¿åº¦
      @item: extract(@data, @i); // æ•°ç»„å…ƒç´ å–å€¼
      div {
          background: @item;
      }
      .for(@data, (@i + 1));
  }

  .for(@colors);


  // è¾“å‡ºcss
  div {
    background: red;
  }
  div {
    background: green;
  }
  div {
    background: blue;
  }
  div {
    background: black;
  }
  ```

## åˆå¹¶

å¯ä»¥å°†åŒä¸€ä¸ªå±æ€§çš„å€¼åˆå¹¶ï¼Œæ¯”å¦‚ `background` å’Œ `transform` ä¹‹ç±»çš„å±æ€§

- `+` ä»£è¡¨å±æ€§åˆå¹¶çš„å€¼ç”¨é€—å·éš”å¼€

  ```less
  .mixin() {
    box-shadow+: inset 0 0 10px #555;
  }
  .myclass {
    .mixin();
    box-shadow+: 0 0 20px black;
  }

  // è¾“å‡ºcss
  .myclass {
    box-shadow: inset 0 0 10px #555, 0 0 20px black;
  }
  ```

- `+_` è¡¨ç¤ºå±æ€§åˆå¹¶çš„å€¼ç”¨ç©ºæ ¼éš”å¼€

  ```less
  .mixin() {
    transform+_: scale(2);
  }
  .myclass {
    .mixin();
    transform+_: rotate(15deg);
  }

  // è¾“å‡ºcss
  .myclass {
    transform: scale(2) rotate(15deg);
  }
  ```

## æ‹¼æ¥å­—ç¬¦ä¸²

- ç”¨ ` '' ` æ‹¼æ¥

  ```less
  @primary-color: #a374d5;
  @color-item: primary;

  @color-name: '@{color-item}-color'; // å˜é‡æ‹¼æ¥å­—ç¬¦ä¸²å¾—åˆ° primary-color

  color: @@color-name; // color: #a374d5;
  ```

- ç”¨ `~''`æ‹¼æ¥ï¼Œå‚è€ƒ [lesså˜é‡æ’å€¼é—®é¢˜](https://segmentfault.com/a/1190000007472208)

  ```less
  // loop start
  .taskSlideBg(@num) when (@num <6){
    @num2:~"@{num}n";
    @color:"mkcolor@{num}";
    #mkUser-task-con .mkUser-task-box:nth-child(@{num2}) .mkUser-task-title{background:@@color;}
    .taskSlideBg((@num+1))
  }
  .taskSlideBg(1);
  // loop end


  <!--ç¼–è¯‘-->
  #mkUser-task-con .mkUser-task-box:nth-child(1n) .mkUser-task-title {
    background: #6ec5ff;
  }
  #mkUser-task-con .mkUser-task-box:nth-child(2n) .mkUser-task-title {
    background: #ff8365;
  }
  ...

  ```

- ä½¿ç”¨åœ¨å±æ€§ calc ä¸­

  ```less
  // ä½¿ç”¨å˜é‡
  .class {
    @cap: 50px;
    height: calc(~"100% - @{cap}");
  }

  // å¾—åˆ°
  .class {
    height: calc(~"100% - 50px");
  }
  ```

  > `~` é€šå¸¸ç”¨åœ¨æ‹¼æ¥å˜é‡ï¼Œä½¿ç”¨jsæ–¹æ³•æ—¶åœ¨å‰é¢æ·»åŠ è¯¥ç¬¦å·ï¼Œå¦‚ ~'' , å’Œ ~`` ï¼Œè¡¨ç¤ºç¼–è¯‘å®Œæˆåå»æ‰åé¢çš„å¼•å·æˆ–è€…åå¼•å·ã€‚


## åœ¨lessä¸­å†™js

- é¦–å…ˆé…ç½®webpackä½¿lessæ”¯æŒç¼–å†™js, åœ¨optionsä¸­æ·»åŠ  `javascriptEnabled: true`

```js
{
  test: /\.less/,
  exclude: /node_modules/,
  use: ['style-loader', 'css-loader', {
    loader: 'less-loader',
    options: {
      javascriptEnabled: true // æ”¯æŒjs
    }
  }],
}
```

- å®ä¾‹
  > [å‚è€ƒ @functionè¶£è°ˆ](https://www.itread01.com/content/1515159652.html) 
| [å‡ ä¹ç›¸åŒçš„å¦ä¸€ç¯‡æ–‡ç« ](https://www.cnblogs.com/mabylove/p/8206264.html)

  ```less
  .paletteMixin() {
    @functions: ~`(function() {
      // æ–¹æ³•1
      this.palette = function(color) { // function()é‡Œé¢ä¼ å…¥color
      return color; // è¿”å›colorï¼Œåˆ™function()é‡Œé¢ä¼ å…¥çš„ä¹Ÿæ˜¯color
      }
      
      // æ–¹æ³•2
      this.test = function(border-radius) {
          return border-raduis;
      }
      
    })()`;
  }

  // è¿è¡Œmixin
  .paletteMixin()
  ```

  ä½¿ç”¨

  ```less
  @primary-color: #123456

  .test {
    color: color(~`palette("@{primary-color}")`);
    border-radius: ~`test('10px')`
  }

  // å¾—åˆ°css
  .test {
      color: #123456;
      border-radius: 10px;
  }
  ```

## ç¼–å†™ç®€å•çš„åè‰²æ–¹æ³•ğŸ¦ğŸ•ğŸŒ­ğŸŒ®ğŸŒ¯ğŸ¥™ğŸ¹
> [é¢œè‰²å·¥å…·-TinyColor](https://github.com/bgrins/TinyColor)
| [antdä¸­è¿˜ç”¨äº†è´å¡å°”æ›²çº¿çš„æ’ä»¶-bezier-easing](https://github.com/gre/bezier-easing)ï¼Œæˆ‘ä»¬ä¸ç”¨å‘¢ï¼**ğŸ¤”** 

### å¼•å…¥tinyColorï¼š

1. å°†[tinyColor.js](https://github.com/bgrins/TinyColor/blob/master/tinycolor.js)å†™å…¥mixinsä¸­ï¼Œä»è€Œå°†`tinyColor.js`è½¬åŒ–ä¸º`tinyColor.less`,æœ€ååœ¨å…¶ä»–lessæ–‡ä»¶ä¸­å¼•å…¥ `tinyColor.less`ã€‚ï¼ˆè¿™é‡Œçš„å·¨å‘å°±æ˜¯ï¼Œæˆ‘ä»¥ä¸ºlessæ–‡ä»¶å¯ä»¥å¼•å…¥jsæ–‡ä»¶æˆ–è€…å¼•å…¥å®‰è£…çš„æ’ä»¶ï¼ŒğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£ğŸ¤£ï¼‰

  ```less
  // tinyColor.less åˆ›å»ºtinyColor.lessæ–‡ä»¶

  .tinyColorMixin() {
    @functionï¼š ~`(tinyColor.jsæ–‡ä»¶å¤åˆ¶è¿›æ¥)` 
  }

  .tinyColorMixin() // åˆ›å»ºmixinï¼Œå¹¶æ‰§è¡Œ
  ```

2. ç›´æ¥å¤åˆ¶antdçš„[tinyColor.lessæ–‡ä»¶](https://github.com/ant-design/ant-design/blob/master/components/style/color/tinyColor.less)

3. ç›´æ¥å¼•å…¥antdçš„tinyColor.lessæ–‡ä»¶

```less
@import '~antd/lib/style/color/tinyColor.less';
```


### ç¼–å†™è‡ªåŠ¨è°ƒè‰²å‡½æ•°
- åˆæ­¥ [å‚è€ƒ-å¼ é‘«æ—­cssè‡ªåŠ¨è°ƒè‰²](https://juejin.im/entry/5bfadeb3e51d456af437d4c2)
ä½†æ˜¯æœ€åçš„é¢œè‰²ä¸å¯¹ï¼ŒèƒŒæ™¯é¢œè‰²çš„æ·±æµ…å®šä¹‰ä¹Ÿä¸æ¸…æ¥šã€‚ğŸ˜­

```less
.palette-mixin() {
  @functions: ~`(
      function() {this.contrastColor = function(color) {var colorRgb = tinycolor(color) .toRgb() ;
        var light = (colorRgb.r * 0.2126 + colorRgb.g * 0.7152 + colorRgb.b * 0.0722) / 255; var
        limit = (light - 0.5) * -999999; return tinycolor.fromRatio({r: 0, g: 0, b: limit})
        .toHslString()}}
    )
    () `;
}

.palette-mixin()
```

- äºŒæ¬¡, åŸºæœ¬ä¸Šå®ç°æ–‡å­—æ ¹æ®èƒŒæ™¯é¢œè‰²æ˜¾ç¤ºç™½è‰²æˆ–é»‘è‰²

```less
.palette-mixin() {
  @functions: ~`(
      function() {this.contrastColor = function(color) {var colorRgb = tinycolor(color) .toRgb() ;
        var colorJudge = colorRgb.r * 0.299 + colorRgb.g * 0.578 + colorRgb.b * 0.114;
        if(colorJudge >= 192) {return tinycolor('#000')}else if(colorJudge < 192){return tinycolor(
          '#fff'
        )}}}
    )
    () `;
}
.palette-mixin();
```